!function(window,angular,undefined){"use strict";var loadDeferred,settings={},flags={sdk:!1,ready:!1};angular.module("facebook",[]).value("settings",settings).value("flags",flags).provider("Facebook",[function(){settings.appId=null,this.setAppId=function(appId){settings.appId=appId},this.getAppId=function(){return settings.appId},settings.locale="en_US",this.setLocale=function(locale){settings.locale=locale},this.getLocale=function(){return settings.locale},settings.status=!0,this.setStatus=function(status){settings.status=status},this.getStatus=function(){return settings.status},settings.channelUrl=null,this.setChannel=function(channel){settings.channelUrl=channel},this.getChannel=function(){return settings.channelUrl},settings.cookie=!0,this.setCookie=function(cookie){settings.cookie=cookie},this.getCookie=function(){return settings.cookie},settings.xfbml=!0,this.setXfbml=function(enable){settings.xfbml=enable},this.getXfbml=function(){return settings.xfbml},this.setAuthResponse=function(obj){settings.authResponse=obj||!0},this.getAuthResponse=function(){return settings.authResponse},settings.frictionlessRequests=!1,this.setFrictionlessRequests=function(enable){settings.frictionlessRequests=enable},this.getFrictionlessRequests=function(){return settings.frictionlessRequests},settings.hideFlashCallback=null,this.setHideFlashCallback=function(obj){settings.hideFlashCallback=obj||null},this.getHideFlashCallback=function(){return settings.hideFlashCallback},this.setInitCustomOption=function(key,value){return angular.isString(key)?(settings[key]=value,settings[key]):!1},this.getInitOption=function(key){return angular.isString(key)&&settings.hasOwnProperty(key)?settings[key]:!1},settings.loadSDK=!0,this.setLoadSDK=function(a){settings.loadSDK=!!a},this.getLoadSDK=function(){return settings.loadSDK},settings.version="v2.0",this.setSdkVersion=function(version){settings.version=version},this.getSdkVersion=function(){return settings.version},this.init=function(initSettings,_loadSDK){angular.isString(initSettings)&&(settings.appId=initSettings),angular.isNumber(initSettings)&&(settings.appId=initSettings.toString()),angular.isObject(initSettings)&&angular.extend(settings,initSettings),angular.isDefined(_loadSDK)&&(settings.loadSDK=!!_loadSDK)},this.$get=["$q","$rootScope","$timeout","$window",function($q,$rootScope,$timeout,$window){function NgFacebook(){this.appId=settings.appId}return NgFacebook.prototype.isReady=function(){return flags.ready},NgFacebook.prototype.login=function(){var userFn,userFnIndex,d=$q.defer(),args=Array.prototype.slice.call(arguments);return angular.forEach(args,function(arg,index){angular.isFunction(arg)&&(userFn=arg,userFnIndex=index)}),angular.isFunction(userFn)&&angular.isNumber(userFnIndex)&&args.splice(userFnIndex,1,function(response){$timeout(function(){response&&angular.isUndefined(response.error)?d.resolve(response):d.reject(response),angular.isFunction(userFn)&&userFn(response)})}),this.isReady()?$window.FB.login.apply($window.FB,args):$timeout(function(){d.reject("Facebook.login() called before Facebook SDK has loaded.")}),d.promise},angular.forEach(["logout","api","ui","getLoginStatus"],function(name){NgFacebook.prototype[name]=function(){var userFn,userFnIndex,d=$q.defer(),args=Array.prototype.slice.call(arguments);return angular.forEach(args,function(arg,index){angular.isFunction(arg)&&(userFn=arg,userFnIndex=index)}),angular.isFunction(userFn)&&angular.isNumber(userFnIndex)&&args.splice(userFnIndex,1,function(response){$timeout(function(){response&&angular.isUndefined(response.error)?d.resolve(response):d.reject(response),angular.isFunction(userFn)&&userFn(response)})}),$timeout(function(){loadDeferred.promise.then(function(){$window.FB[name].apply(FB,args)})}),d.promise}}),NgFacebook.prototype.parseXFBML=function(){var d=$q.defer();return $timeout(function(){loadDeferred.promise.then(function(){$window.FB.XFBML.parse(),d.resolve()})}),d.promise},angular.forEach(["subscribe","unsubscribe"],function(name){NgFacebook.prototype[name]=function(){var userFn,userFnIndex,d=$q.defer(),args=Array.prototype.slice.call(arguments);return angular.forEach(args,function(arg,index){angular.isFunction(arg)&&(userFn=arg,userFnIndex=index)}),angular.isFunction(userFn)&&angular.isNumber(userFnIndex)&&args.splice(userFnIndex,1,function(response){$timeout(function(){response&&angular.isUndefined(response.error)?d.resolve(response):d.reject(response),angular.isFunction(userFn)&&userFn(response)})}),$timeout(function(){loadDeferred.promise.then(function(){$window.FB.Event[name].apply(FB,args)})}),d.promise}}),new NgFacebook}]}]).run(["$rootScope","$q","$window","$timeout",function($rootScope,$q,$window,$timeout){loadDeferred=$q.defer();var loadSDK=settings.loadSDK;delete settings.loadSDK,$window.fbAsyncInit=function(){$timeout(function(){if(!settings.appId)throw"Missing appId setting.";FB.init(settings),flags.ready=!0,angular.forEach({"auth.login":"login","auth.logout":"logout","auth.prompt":"prompt","auth.sessionChange":"sessionChange","auth.statusChange":"statusChange","auth.authResponseChange":"authResponseChange","xfbml.render":"xfbmlRender","edge.create":"like","edge.remove":"unlike","comment.create":"comment","comment.remove":"uncomment"},function(mapped,name){FB.Event.subscribe(name,function(response){$timeout(function(){$rootScope.$broadcast("Facebook:"+mapped,response)})})}),$rootScope.$broadcast("Facebook:load"),loadDeferred.resolve(FB)})},function(){var fbroot=document.getElementById("fb-root");return fbroot||(fbroot=document.createElement("div"),fbroot.id="fb-root",document.body.insertBefore(fbroot,document.body.childNodes[0])),fbroot}(),loadSDK&&!function(){var src="//connect.facebook.net/"+settings.locale+"/sdk.js",script=document.createElement("script");script.id="facebook-jssdk",script.async=!0,-1!==$window.location.protocol.indexOf("file:")&&(src="https:"+src),script.src=src,script.onload=function(){flags.sdk=!0},document.getElementsByTagName("head")[0].appendChild(script)}()}])}(window,angular);